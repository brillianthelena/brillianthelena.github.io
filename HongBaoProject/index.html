<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>唱給不在場的人</title>

  <!-- 思源宋體（網頁等價） -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600;700;900&display=swap" rel="stylesheet">

  <style>
    :root {
      --red: #970C10;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "Noto Serif TC", serif;
      background: #000;
      color: #fff;
      overflow-x: hidden;
    }

    h5 {
      font-size: clamp(1rem, 1.6vw, 1.3rem);
      font-weight: 500;
      line-height: 1.8;
      margin: 0;
      color: inherit;
    }

    /* =========================
       Section 1｜Full-screen Video
    ========================== */
    .landing-wrapper {
      position: relative;
      height: 200vh;
      width: 100%;
    }

    .landing-video {
      position: sticky;
      top: 0;
      width: 100%;
      height: 100vh;
      overflow: hidden;
    }

    .landing-video video {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .landing-hint {
      position: absolute;
      z-index: 2;
      bottom: 2.5rem;
      left: 50%;
      transform: translateX(-50%);
      color: rgba(255,255,255,0.85);
      font-size: 0.9rem;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      animation: hint-float 2s ease-in-out infinite;
      pointer-events: none;
    }

    /* 可微調暗度，讓影片不刺眼 */
    .landing-video::after {
      content: "";
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.25);
      z-index: 1;
    }

    /* =========================
       Section 3｜Hero Section
    ========================== */
    .hero {
      position: relative;
      height: 100vh;
      min-height: 100vh;
      background: var(--red);
      overflow: visible;
      display: flex;
      align-items: center;
      padding: 0 7vw;
      gap: min(6vw, 64px);
    }

    /* 顆粒層 */
    .hero::before {
      content: "";
      position: absolute;
      inset: 0;
      background: url("assets/grain.png") repeat;
      opacity: 0.3;
      z-index: 1;
    }

    /* 人物圖層 */
    .hero-image {
      position: absolute;
      right: 0;
      bottom: 0;
      display: flex;
      justify-content: flex-end;
      align-items: flex-end;
      z-index: 2;
      pointer-events: none;
    }

    .hero-image img {
      width: clamp(420px, 60vw, 920px);
      max-height: 92vh;
      height: auto;
      object-fit: contain;
    }

    /* 文字內容 */
    .hero-content {
      position: relative;
      z-index: 3;
      flex: 0 1 48%;
      max-width: 640px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      min-height: 100%;
    }

    .hero h1 {
      font-size: clamp(2.5rem, 5vw, 4rem);
      font-weight: 900;
      color: #FFE87A;
      margin-bottom: 1rem;
      letter-spacing: 0.05em;
    }

    .hero h2 {
      font-size: clamp(1.4rem, 3vw, 2.2rem);
      font-weight: 700;
      color: #FFE87A;
      margin-bottom: 1.5rem;
    }

    .hero h3 {
      font-size: clamp(1rem, 2.2vw, 1.3rem);
      font-weight: 600;
      color: #fff;
      letter-spacing: 0.08em;
      margin-bottom: 2rem;
    }

    /* Desktop keeps Chinese titles on a single line */
    .hero h1,
    .hero h2 {
      white-space: nowrap;
    }

    .hero .en {
      font-size: clamp(1.1rem, 2.2vw, 1.8rem);
      font-weight: 700;
      line-height: 1.45;
      color: rgba(255,255,255,0.9);
      max-width: 28ch;            /* 你可以在 26–34ch 微調 */
      text-wrap: balance;         /* 支援的瀏覽器會自動平衡每行長度 */
      overflow-wrap: anywhere;    /* 保底：避免奇怪溢出 */
    }

    .typewriter-line {
      display: inline-block;
      position: relative;
      min-height: 1em;
      overflow: hidden;
    }

    .typewriter-line.typing::after {
      content: "";
      position: absolute;
      right: -0.1em;
      top: 50%;
      transform: translateY(-50%);
      height: 1.2em;
      width: 2px;
      background: #FFE87A;
      animation: caret-blink 0.8s steps(1) infinite;
    }

    .typewriter-line.done::after {
      animation: none;
      opacity: 0;
    }

    .hero-entrance {
      opacity: 0;
      transform: translateY(24px);
      transition: opacity 1.2s ease-out, transform 1.2s ease-out;
      transition-delay: var(--delay, 0ms);
    }

    .hero-entrance.is-visible {
      opacity: 1;
      transform: translateY(0);
    }

    .scroll-hint {
      position: absolute;
      bottom: 3rem;
      left: 50%;
      transform: translate(-50%, 0.5rem);
      font-size: 0.9rem;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.85);
      opacity: 0;
      transition: opacity 0.6s ease, transform 0.6s ease;
      pointer-events: none;
    }

    .scroll-hint.visible {
      opacity: 1;
      transform: translate(-50%, 0);
      animation: hint-float 2s ease-in-out infinite;
    }

    @keyframes caret-blink {
      0%, 49% { opacity: 1; }
      50%, 100% { opacity: 0; }
    }

    @keyframes hint-float {
      0% { transform: translate(-50%, 0); }
      50% { transform: translate(-50%, -8px); }
      100% { transform: translate(-50%, 0); }
    }

    .immersive-section {
      background: #000;
      min-height: 150vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 10vh 1.5rem;
      position: relative;
      overflow: hidden;
    }

    .immersive-inner {
      max-width: 680px;
      text-align: center;
      color: #fff;
      line-height: 1.8;
      font-size: clamp(1.1rem, 2.2vw, 1.4rem);
      letter-spacing: 0.03em;
    }

    .immersive-copy {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    .immersive-copy h5 {
      color: #fff;
      letter-spacing: 0.04em;
      opacity: 0;
      transform: translateY(24px);
      transition: opacity 1s ease-out, transform 1s ease-out;
    }

    .immersive-copy h5.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .transition-spacer {
      position: relative;
      min-height: 120vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 6vw;
      background: #000;
      color: rgba(255,255,255,0.6);
      letter-spacing: 0.05em;
      text-transform: uppercase;
      font-size: 0.85rem;
    }

    .chapter-stack {
      position: relative;
    }

    .chapter-intro {
      position: sticky;
      top: 0;
      height: 100vh;
      min-height: 100vh;
      background: #111;
      overflow: hidden;
      z-index: 2;
    }

    .chapter-intro img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .chapter-intro::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(0,0,0,0.92) 0%, rgba(0,0,0,0.3) 22%, transparent 55%);
      filter: blur(12px);
      pointer-events: none;
    }

    .chapter-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(8,8,8,0.08) 0%, rgba(8,8,8,0.55) 92%);
    }

    .chapter-title {
      position: absolute;
      left: 5vw;
      top: 50%;
      transform: translateY(-50%);
      color: #fff;
      font-size: clamp(1rem, 2.2vw, 1.8rem);
      font-weight: 600;
      letter-spacing: 0.08em;
      max-width: 520px;
      line-height: 1.4;
      white-space: nowrap;
      text-align: left;
      z-index: 5;
    }

    .chapter-body {
      position: relative;
      background: #970C10;
      color: #fff;
      min-height: 110vh;
      padding: clamp(60px, 10vh, 120px) clamp(6vw, 10vw, 12vw);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 3;
    }

    .black-finale {
      background: #000;
      min-height: 100vh;
      display: grid;
      grid-template-columns: 50vw 50vw;
      width: 100%;
    }

    .finale-image {
      position: relative;
      min-height: 100vh;
      overflow: hidden;
    }

    .finale-image img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .finale-text {
      background: #000;
      color: #fff;
      padding: clamp(60px, 12vh, 120px) clamp(6vw, 10vw, 12vw);
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 1rem;
      text-align: left;
    }

    .finale-text h3 {
      color: #FFE87A;
      letter-spacing: 0.1em;
      margin-bottom: 0.5rem;
    }

    .finale-text h4 {
      font-weight: 500;
      line-height: 1.8;
      color: #fff;
      margin: 0;
    }

    .black-quote {
      background: #000;
      min-height: 120vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: clamp(60px, 15vh, 140px) clamp(6vw, 12vw, 14vw);
    }

    .black-quote h3 {
      color: #fff;
      text-align: center;
      letter-spacing: 0.1em;
      line-height: 1.8;
      max-width: 820px;
      opacity: 0;
      transform: translateY(40px);
      transition: opacity 1.2s ease, transform 1.2s ease;
    }

    .black-quote h3.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .black-quote h3 span {
      transition: color 0.8s ease;
    }

    .black-quote h3.highlight span {
      color: #FFE87A;
    }

    .chapter-body-inner {
      position: relative;
      width: min(1200px, 100%);
      display: flex;
      align-items: center;
      gap: clamp(2rem, 6vw, 5rem);
    }

    .chapter-body::before {
      content: "";
      position: absolute;
      inset: 0;
      background: url("assets/grain.png") repeat;
      opacity: 0.2;
      filter: blur(0.5px);
      pointer-events: none;
    }

    .chapter-text-block {
      flex: 1 1 55%;
      text-align: left;
      display: flex;
      flex-direction: column;
      gap: clamp(1rem, 2.5vw, 1.8rem);
    }

    .chapter-text-block h3 {
      font-size: clamp(1.2rem, 2.4vw, 2.2rem);
      color: #FFE87A;
      font-weight: 600;
      letter-spacing: 0.1em;
      margin: 0;
      text-align: left;
    }

    .chapter-text-block h5 {
      color: #fff;
      text-align: left;
    }

    .vinyl-column {
      flex: 1 1 45%;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.2rem;
    }

    .vinyl-player {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }

    .vinyl-disc {
      width: clamp(160px, 22vw, 220px);
      height: clamp(160px, 22vw, 220px);
      border-radius: 50%;
      background: radial-gradient(circle at center, #1f1f1f 0%, #050505 60%, #000 100%);
      border: 6px solid #222;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 12px 30px rgba(0,0,0,0.45);
      animation: vinyl-spin 8s linear infinite;
      animation-play-state: paused;
      cursor: pointer;
    }

    .vinyl-disc::before,
    .vinyl-disc::after {
      content: "";
      position: absolute;
      border-radius: 50%;
      border: 1px solid rgba(255,255,255,0.07);
    }

    .vinyl-disc::before {
      inset: 14%;
    }

    .vinyl-disc::after {
      inset: 32%;
    }

    .vinyl-label {
      width: 38%;
      height: 38%;
      border-radius: 50%;
      background: radial-gradient(circle, #b91c1c 0%, #741010 80%);
      border: 3px solid #ffe87a;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: 0.65rem;
      text-align: center;
      letter-spacing: 0.08em;
      color: #ffe7a0;
      font-weight: 600;
    }

    .vinyl-disc.is-playing {
      animation-play-state: running;
    }

    .vinyl-cta {
      border: 1px solid rgba(255,255,255,0.35);
      background: transparent;
      color: #ffe87a;
      padding: 0.75rem 1.5rem;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      font-size: 0.75rem;
      cursor: pointer;
      transition: background 0.3s ease, color 0.3s ease;
    }

    .vinyl-cta:hover {
      background: rgba(255,255,255,0.08);
      color: #fff;
    }

    @keyframes vinyl-spin {
      to { transform: rotate(360deg); }
    }

    /* 手機版調整 */
    @media (max-width: 900px) {
      .chapter-body {
        min-height: unset;
        padding: clamp(48px, 8vh, 80px) clamp(5vw, 8vw, 10vw);
      }

      .chapter-body-inner {
        flex-direction: column;
        text-align: center;
      }

      .chapter-text-block {
        text-align: center;
      }

      .chapter-text-block h3,
      .chapter-text-block h5 {
        text-align: center;
      }

      .vinyl-column {
        width: 100%;
      }

      .black-finale {
        grid-template-columns: 1fr;
      }

      .finale-image {
        min-height: clamp(260px, 45vh, 420px);
      }
    }

    /* 手機版調整 */
    @media (max-width: 768px) {
      .hero {
        padding: 4vh 8vw;
      }

      .hero-content {
        flex: 1 1 auto;
        min-height: auto;
      }

      .hero-image {
        right: -5vw;
        bottom: 1rem;
        opacity: 0.6;
      }

      .hero-image img {
        width: min(78vw, 420px);
        max-height: 60vh;
      }

      /* Let mobile wrap naturally to avoid overflow */
      .hero h1,
      .hero h2 {
        white-space: normal;
      }

      .chapter-title {
        white-space: normal;
        top: auto;
        bottom: 2rem;
        transform: none;
      }

      .scroll-hint {
        letter-spacing: 0.2em;
        bottom: 2rem;
      }
    }
  </style>
</head>

<body>

  <!-- Section 1：滿版影片 -->
  <div class="landing-wrapper">
    <section class="landing-video">
      <video 
        id="landing-video"
        src="assets/stage.mp4"
        autoplay
        muted
        loop
        playsinline
        preload="auto">
      </video>
      <div class="landing-hint">SCROLL ↓</div>
    </section>
  </div>

  <!-- Section 3：Hero -->
  <section class="hero">
    <div class="hero-content">
      <h1 id="hero-title" class="typewriter-line" data-text="唱給不在場的人"></h1>
      <h2 id="hero-subtitle" class="typewriter-line" data-text="紅包歌手的世代誤解與生存現場"></h2>
    </div>

    <div class="hero-image hero-entrance" style="--delay: 0ms;">
      <img src="assets/hero_cover.png" alt="紅包場歌手英姿">
    </div>

    <div id="scroll-hint" class="scroll-hint">SCROLL ↓</div>
  </section>

  <section class="immersive-section">
    <div class="immersive-inner">
      <div class="immersive-copy">
        <h5>夜晚的西門町總帶著一種說不出的濕氣。</h5>
        <h5>對多數年輕人來說，</h5>
        <h5>紅包場可能是陌生、甚至帶點神祕色彩的存在。</h5>
        <h5>但在台灣的某段歷史裡，它曾是上萬個孤單靈魂的歸屬；</h5>
        <h5>是一座用歌聲聚起的庶民劇院；</h5>
        <h5>也是一個動盪年代裡最溫暖的避風港。</h5>
      </div>
    </div>
  </section>

  <div class="chapter-stack">
    <section class="chapter-intro">
      <img src="assets/red-envelope-theater.jpg" alt="紅包場場景">
      <div class="chapter-overlay"></div>
      <div class="chapter-title">➀ 燈紅酒綠的年代 — 紅包場的誕生與繁華</div>
    </section>

    <section class="chapter-body">
      <div class="chapter-body-inner">
        <div class="chapter-text-block">
          <h3>「一扇門，通往另一個年代」</h3>
          <h5>當你步出西門町六號出口的喧囂，轉身踏入一棟舊式商辦大樓，搭上那部略顯陳舊的電梯，六樓的門一開，整個世界彷彿瞬間被按下了倒轉鍵。</h5>
          <h5>牆上勾勒出「金鑽大歌廳」的霓虹燈條閃爍著溫潤的光，那是經營者親手設計的風景，為這片天地注入了第一份屬於自己的溫度。</h5>
          <h5>空氣中混雜著一絲甜膩的香水、菜餚的油香，以及時間沉澱在紅絲絨座椅上的陳舊氣味。樂隊老師們早已就位，薩克斯風吹奏出的，是鄧麗君、是鳳飛飛，是那個你我或許未曾親歷，卻無比熟悉的黃金年代旋律。</h5>
        </div>
        <div class="vinyl-column">
          <div class="vinyl-player">
            <div class="vinyl-disc" id="vinyl-disc">
              <div class="vinyl-label">
                群星會<br/>1970
              </div>
            </div>
            <button class="vinyl-cta" id="vinyl-toggle">點擊播放時代氛圍</button>
            <audio id="vinyl-audio" src="assets/moon.mp3"></audio>
          </div>
        </div>
      </div>
    </section>
  </div>

  <section class="black-finale">
    <div class="finale-image">
      <img src="assets/lonely_man.jpg" alt="lonely man">
    </div>
    <div class="finale-text">
      <h3>紅包場為何誕生？</h3>
      <h4>故事要從民國三、四十年說起。</h4>
      <h4>隨著國民政府遷臺，大量隨軍來臺的軍人與軍眷湧入島內。其中，有相當比例是未婚的外省籍男性。他們離開原鄉，失去了原有的社會網絡，長期居住在簡陋的臨時宿舍或眷村，生活條件拮据，精神狀態亦長期處於孤立狀態。</h4>
      <h4>對這群人而言，娛樂不只是消遣，而是一種維繫生活平衡的必要條件。</h4>
    </div>
  </section>

  <section class="black-quote">
    <h3 id="quote-line">
      <span>對那些不屬於本地、也未必能想像未來的人來說，</span><br>
      <span>歌廳，是讓自己不那麼孤單的地方。</span>
    </h3>
  </section>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const hero = document.querySelector(".hero");
      const titleEl = document.getElementById("hero-title");
      const subtitleEl = document.getElementById("hero-subtitle");
      const heroImage = document.querySelector(".hero-image.hero-entrance");
      const scrollHint = document.getElementById("scroll-hint");
      const typeTargets = [titleEl, subtitleEl];
      const narrativeLines = document.querySelectorAll(".immersive-copy h5");
      let hasRun = false;
      let scrollLocked = false;
      let prevBodyOverflow = "";
      let prevHtmlOverflow = "";
      let unlockTimer = null;

      typeTargets.forEach((el) => {
        const text = el.dataset.text || el.textContent.trim();
        el.dataset.text = text;
        el.textContent = "";
      });

      const wait = (ms) => new Promise((resolve) => setTimeout(resolve, ms));

      const lockScroll = () => {
        if (scrollLocked) return;
        scrollLocked = true;
        prevBodyOverflow = document.body.style.overflow;
        prevHtmlOverflow = document.documentElement.style.overflow;
        document.body.style.overflow = "hidden";
        document.documentElement.style.overflow = "hidden";
      };

      const unlockScroll = () => {
        if (!scrollLocked) return;
        scrollLocked = false;
        document.body.style.overflow = prevBodyOverflow;
        document.documentElement.style.overflow = prevHtmlOverflow;
        if (unlockTimer) {
          clearTimeout(unlockTimer);
          unlockTimer = null;
        }
      };

      const typeText = (el, speed = 120) =>
        new Promise((resolve) => {
          const text = el.dataset.text || "";
          let index = 0;
          el.classList.add("typing");
          const tick = () => {
            el.textContent += text.charAt(index);
            index += 1;
            if (index < text.length) {
              setTimeout(tick, speed);
            } else {
              el.classList.remove("typing");
              el.classList.add("done");
              resolve();
            }
          };
          tick();
        });

      const heroFullyVisible = () => {
        if (!hero) return false;
        const rect = hero.getBoundingClientRect();
        const tolerance = 1;
        return Math.abs(rect.top) <= tolerance;
      };

      const cleanupHeroListeners = () => {
        window.removeEventListener("scroll", onScrollCheck, { passive: true });
        window.removeEventListener("resize", onScrollCheck);
      };

      let scrollCheckQueued = false;
      const scheduleHeroCheck = () => {
        if (hasRun || scrollCheckQueued) return;
        scrollCheckQueued = true;
        requestAnimationFrame(() => {
          scrollCheckQueued = false;
          if (heroFullyVisible()) {
            cleanupHeroListeners();
            startSequence();
          }
        });
      };

      const onScrollCheck = () => scheduleHeroCheck();

      const startSequence = async () => {
        if (hasRun) return;
        hasRun = true;
        lockScroll();
        unlockTimer = setTimeout(unlockScroll, 9000);
        await wait(500);
        for (const el of typeTargets) {
          await typeText(el);
        }
        requestAnimationFrame(() => {
          if (heroImage) heroImage.classList.add("is-visible");
        });
        requestAnimationFrame(() => {
          setTimeout(() => {
            scrollHint.classList.add("visible");
            unlockScroll();
          }, 600);
        });
      };

      window.addEventListener("scroll", onScrollCheck, { passive: true });
      window.addEventListener("resize", onScrollCheck);
      scheduleHeroCheck();

      if (narrativeLines.length) {
        const narrativeObserver = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                narrativeLines.forEach((line, idx) => {
                  line.style.transitionDelay = `${idx * 130}ms`;
                  requestAnimationFrame(() => line.classList.add("visible"));
                });
                narrativeObserver.disconnect();
              }
            });
          },
          { threshold: 0.2 }
        );
        narrativeObserver.observe(narrativeLines[0]);
      }

      const quoteLine = document.getElementById("quote-line");
      if (quoteLine) {
        const quoteObserver = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                quoteLine.classList.add("visible");
                setTimeout(() => quoteLine.classList.add("highlight"), 600);
                quoteObserver.disconnect();
              }
            });
          },
          { threshold: 0.6 }
        );
        quoteObserver.observe(quoteLine);
      }

      const vinylDisc = document.getElementById("vinyl-disc");
      const vinylToggle = document.getElementById("vinyl-toggle");
      const vinylAudio = document.getElementById("vinyl-audio");

      if (vinylDisc && vinylToggle && vinylAudio) {
        const updateVinylState = () => {
          if (vinylAudio.paused) {
            vinylDisc.classList.remove("is-playing");
            vinylToggle.textContent = "點擊播放時代氛圍";
          } else {
            vinylDisc.classList.add("is-playing");
            vinylToggle.textContent = "點擊暫停時代氛圍";
          }
        };

        const toggleVinyl = () => {
          if (vinylAudio.paused) {
            vinylAudio.play().catch(() => {});
          } else {
            vinylAudio.pause();
          }
          updateVinylState();
        };

        vinylDisc.addEventListener("click", toggleVinyl);
        vinylToggle.addEventListener("click", toggleVinyl);
        vinylAudio.addEventListener("ended", () => {
          vinylAudio.pause();
          vinylAudio.currentTime = 0;
          updateVinylState();
        });
        vinylAudio.addEventListener("pause", updateVinylState);
        vinylAudio.addEventListener("play", updateVinylState);
        updateVinylState();
      }
    });
  </script>
</body>
</html>
